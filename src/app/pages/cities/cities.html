<div class="mb-8 flex flex-col items-center">
  <h1 class="text-4xl lg:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-cyan-500 mb-2 tracking-tight">
    Cities Management
  </h1>
  <p class="text-surface-500 dark:text-surface-400 text-lg font-medium">Manage available cities for the platform</p>
</div>

<div class="card mb-5 max-w-4xl mx-auto">
  <!-- Add City Section -->
  <div class="bg-white dark:bg-surface-900 p-6 rounded-xl border border-surface-200 dark:border-surface-700 shadow-sm mb-6">
    <h2 class="text-xl font-semibold mb-4 text-surface-900 dark:text-surface-0">Add New City</h2>
    <div class="flex gap-4">
      <input 
        pInputText 
        type="text" 
        [(ngModel)]="newCityName" 
        placeholder="Enter city name..." 
        class="flex-1"
        (keydown.enter)="createCity()"
      />
      <p-button 
        label="Add City" 
        icon="pi pi-plus" 
        (onClick)="createCity()" 
        [loading]="isCreating()"
        [disabled]="!newCityName().trim()"
        severity="primary">
      </p-button>
    </div>
  </div>

  <!-- Cities Table -->
  <p-table
    [value]="cities()"
    [loading]="loading()"
    [tableStyle]="{ 'min-width': '30rem' }"
    styleClass="p-datatable-gridlines border border-surface-200 dark:border-surface-700 rounded-xl overflow-hidden shadow-sm"
  >
    <ng-template pTemplate="header">
      <tr>
        <th style="width:60%" class="bg-blue-50 dark:bg-blue-900/20 border-b border-blue-100 dark:border-blue-900/30 font-semibold text-blue-900 dark:text-blue-100">Name</th>
        <th style="width:40%" class="bg-blue-50 dark:bg-blue-900/20 border-b border-blue-100 dark:border-blue-900/30 font-semibold text-blue-900 dark:text-blue-100">Actions</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-city>
      <tr class="border-b border-surface-100 dark:border-surface-800">
        <td>
          <div *ngIf="editingCityId() !== city.id" class="font-medium text-lg">{{ city.name }}</div>
          <div *ngIf="editingCityId() === city.id" class="w-full">
            <input 
              pInputText 
              type="text" 
              [(ngModel)]="editingCityName" 
              class="w-full"
              (keydown.enter)="saveEdit(city)"
              autofocus
            />
          </div>
        </td>
        <td>
          <!-- View Mode Actions -->
          <div *ngIf="editingCityId() !== city.id" class="flex gap-2">
            <p-button 
              icon="pi pi-pencil" 
              [rounded]="true" 
              [text]="true" 
              severity="warn" 
              (onClick)="startEdit(city)"
              pTooltip="Edit">
            </p-button>
            <p-button 
              icon="pi pi-trash" 
              [rounded]="true" 
              [text]="true" 
              severity="danger" 
              (onClick)="deleteCity($event, city)"
              pTooltip="Delete">
            </p-button>
          </div>

          <!-- Edit Mode Actions -->
          <div *ngIf="editingCityId() === city.id" class="flex gap-2">
            <p-button 
              icon="pi pi-check" 
              [rounded]="true" 
              [text]="true" 
              severity="success" 
              (onClick)="saveEdit(city)"
              [loading]="isUpdating()"
              pTooltip="Save">
            </p-button>
            <p-button 
              icon="pi pi-times" 
              [rounded]="true" 
              [text]="true" 
              severity="secondary" 
              (onClick)="cancelEdit()"
              pTooltip="Cancel">
            </p-button>
          </div>
        </td>
      </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="2" class="text-center p-4 text-surface-500">No cities found.</td>
      </tr>
    </ng-template>
  </p-table>
</div>

<p-confirmDialog></p-confirmDialog>
<p-toast></p-toast>
